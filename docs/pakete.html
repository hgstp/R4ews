<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Kapitel 12 Pakete | R4ews MA0009</title>
<meta name="author" content="Stephan Haug">
<meta name="description" content="Bei einem Paket üì¶ handelt es sich um eine strukturierte, standardisierte Einheit, welche aus R Code, Dokumentation, Daten und (m√∂glicherweise) externem Quellcode besteht. Wie man ein Paket...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Kapitel 12 Pakete | R4ews MA0009">
<meta property="og:type" content="book">
<meta property="og:description" content="Bei einem Paket üì¶ handelt es sich um eine strukturierte, standardisierte Einheit, welche aus R Code, Dokumentation, Daten und (m√∂glicherweise) externem Quellcode besteht. Wie man ein Paket...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Kapitel 12 Pakete | R4ews MA0009">
<meta name="twitter:description" content="Bei einem Paket üì¶ handelt es sich um eine strukturierte, standardisierte Einheit, welche aus R Code, Dokumentation, Daten und (m√∂glicherweise) externem Quellcode besteht. Wie man ein Paket...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lato-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="anchor-links.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-68219208-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-68219208-1');
      </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="r4ews.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R4ews MA0009</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">R4ews</a></li>
<li class="book-part">R, wie fange ich an</li>
<li><a class="" href="install.html"><span class="header-section-number">1</span> Installieren von R und RStudio</a></li>
<li><a class="" href="r-basics.html"><span class="header-section-number">2</span> R Basics und Arbeitsabl√§ufe</a></li>
<li class="book-part">Versionskontrolle und R Markdown</li>
<li><a class="" href="version-control.html"><span class="header-section-number">3</span> Git, GitHub, and RStudio</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">4</span> R Markdown</a></li>
<li class="book-part">Datenanalyse Intro</li>
<li><a class="" href="data-intro.html"><span class="header-section-number">5</span> Letzte Vorbereitungen ‚Ä¶</a></li>
<li><a class="" href="dplyr-intro.html"><span class="header-section-number">6</span> Einf√ºhrung in dplyr</a></li>
<li><a class="" href="dplyr-single.html"><span class="header-section-number">7</span> Mehr zu dplyr</a></li>
<li><a class="" href="import-export.html"><span class="header-section-number">8</span> Daten I/O</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">9</span> tidy was?</a></li>
<li class="book-part">ggplot2 Intro</li>
<li><a class="" href="einfuehrung-ggplot2.html"><span class="header-section-number">10</span> Einf√ºhrung</a></li>
<li><a class="" href="bausteine.html"><span class="header-section-number">11</span> Bausteine</a></li>
<li class="book-part">Wir schreiben ein Paket</li>
<li><a class="active" href="pakete.html"><span class="header-section-number">12</span> Pakete</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="funktionen.html"><span class="header-section-number">13</span> Funktionen</a></li>
<li><a class="" href="envscop.html"><span class="header-section-number">14</span> Environments und Scoping</a></li>
<li><a class="" href="literatur-3.html">Literatur</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="pakete" class="section level1" number="12">
<h1>
<span class="header-section-number">Kapitel 12</span> Pakete<a class="anchor" aria-label="anchor" href="#pakete"><i class="fas fa-link"></i></a>
</h1>
<p>Bei einem Paket üì¶ handelt es sich um</p>
<div class="content-box-blue">
<p>eine strukturierte, standardisierte Einheit, welche aus R Code, Dokumentation, Daten und (m√∂glicherweise) externem Quellcode besteht.</p>
</div>
<p>Wie man ein Paket installiert und l√§dt, ist uns mittlerweile bekannt. Jetzt wollen wir eigene Pakete erstellen.</p>
<p>Gute Gr√ºnde f√ºr die Verwendung von Paketen:</p>
<ul>
<li><p>dynamisches Laden und Entladen des Pakets (Speicherplatz
sparend)</p></li>
<li><p>einfache Installation und Update von lokalen Datentr√§gern √ºber
das Web (innerhalb von R oder √ºber die Kommandozeile des
Betriebssystems)</p></li>
<li><p>Validierung: R bietet Befehle zur groben √úberpr√ºfung von Code,
Dokumentation und Installierbarkeit, sowie, falls man m√∂chte,
√úberpr√ºfung von Berechnungsergebnissen</p></li>
<li><p>einfache Verteilung der Software an Dritte</p></li>
<li><p>Beispieldatens√§tze k√∂nnen in das Paket integriert werden</p></li>
</ul>
<div id="struktur" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Struktur<a class="anchor" aria-label="anchor" href="#struktur"><i class="fas fa-link"></i></a>
</h2>
<p>Ein Paket besteht aus einigen Standard‚ÄìDateien und Verzeichnissen:</p>
<ul>
<li>
<code>DESCRIPTION</code>: Informationen √ºber das Paket (Autor,
Lizenz, Titel, Abh√§ngigkeiten, ‚Ä¶)</li>
<li>
<code>R/</code>: R Code in <code>.R</code> Dateien</li>
<li>
<code>man/</code>: Dokumentationen (im <code>*.Rd</code> Format) der einzelnen Funktionen</li>
<li>
<code>NAMESPACE</code>: Information √ºber die zu ‚Äúexportierenden‚Äù Funktionen</li>
<li>
<code>data/</code>: Datenbeispiele</li>
<li>
<code>src/</code>: kompilierter C, C++ oder Fortran Code</li>
<li>
<code>tests/</code>: Testroutinen zur Validierung des Pakets</li>
</ul>
<p>Bei der Erzeugung der Struktur (wie auch weiteren Schritten bei der Entwicklung) sollte man so viel wie m√∂glich automatisieren. Wir verwenden dazu die von Hadley Wickham bereitgestellten Werkzeuge.</p>
<p>Falls noch nicht geschehen, solltet ihr die Pakete <code>devtools</code>, <code>roxygen2</code> und <code>testthat</code> installieren</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"devtools"</span>, <span class="st">"roxygen2"</span>, <span class="st">"testthat"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Diese Pakete erleichtern in Kombination mit RStudio das Erstellen von Paketen.</p>
</div>
<div id="c-compiler" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> C Compiler<a class="anchor" aria-label="anchor" href="#c-compiler"><i class="fas fa-link"></i></a>
</h2>
<p>Um alle M√∂glichkeiten bei der Erstellung von R-Paketen ausn√ºtzen zu k√∂nnen, ben√∂tigt man zus√§tzlich noch einen C Compiler und ein paar andere Werkzeuge. Dies ist aber vermutlich erst dann wirklich n√∂tig, wenn ihr Pakete bauen wollt, die C- oder C++-Code enthalten (nicht Teil des Kurses). RStudio sollte dich auch warnen und dir Unterst√ºtzung anbieten, sobald du versuchen solltest, etwas zu tun, das die Einrichtung einer Entwicklungsumgebung erfordert.</p>
<p>Mit <code><a href="https://pkgbuild.r-lib.org/reference/has_compiler.html">has_devel()</a></code> k√∂nnt ihr aber auch schon jetzt √ºberpr√ºfen ob euer System vielleicht schon bereit dazu w√§re</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pkgbuild.r-lib.org/reference/has_compiler.html">has_devel</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Your system is ready to build packages!</code></pre>
<p>Dies scheint bei mir der Fall zu sein.</p>
</div>
<div id="r-code" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> R Code<a class="anchor" aria-label="anchor" href="#r-code"><i class="fas fa-link"></i></a>
</h2>
<p>Das Verzeichnis <code>R/</code> ist der wichtigste Bestandteil eines Pakets, da dort der komplette R Code liegt.
Dieses Verzeichnis (wie auch andere Teile) erzeugt man mit der Funktion <code><a href="https://devtools.r-lib.org/reference/create.html">devtools::create()</a></code>, z.B.</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://devtools.r-lib.org/reference/create.html">create</a></span><span class="op">(</span><span class="st">"Pfad_zum_Paket/Paketname"</span><span class="op">)</span></span></code></pre></div>
<p>Dieser Befehl erzeugt das Verzeichnis <code>Pfad_zum_Paket/Paketname</code>, welches</p>
<ol style="list-style-type: decimal">
<li>eine RStudio Projektdatei, <code>Paketname.Rproj</code>
</li>
<li>ein <code>R/</code> Verzeichnis</li>
<li>eine <code>DESCRIPTION</code> Datei</li>
<li>eine <code>NAMESPACE</code> Datei</li>
</ol>
<p>enth√§lt. Allen R Code, der im Paket enthalten sein soll, kopiert man anschlie√üend in das Verzeichnis <code>Pfad_zum_Paket/Paketname/R</code>.</p>
<p>Innerhalb eines Pakets ist es nun einfach den kompletten R Code (nach √Ñnderungen) neu zu laden.</p>
<ul>
<li>
<code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all()</a></code> l√§dt allen R Code neu. In RStudio auch √ºber <strong>Strg + Shift + L</strong> m√∂glich.</li>
<li>In RStudio kann man mit <strong>Strg + Shift + B</strong> das Paket installieren, R neu starten und anschlie√üend das Paket √ºber <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> neu laden.</li>
</ul>
<p>Dadurch ergibt sich der folgende Arbeitsablauf</p>
<ol style="list-style-type: decimal">
<li>R Dateien im Editor bearbeiten</li>
<li>Strg + Shift + L (oder Strg + Shift + B) ausf√ºhren</li>
<li>Code in der Konsole √ºberpr√ºfen</li>
<li>Das Ganze (falls n√∂tig) wiederholen</li>
</ol>
</div>
<div id="verschiedene-typen" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Verschiedene Typen<a class="anchor" aria-label="anchor" href="#verschiedene-typen"><i class="fas fa-link"></i></a>
</h2>
<p>Man unterscheidet f√ºnf verschiedene Typen: <em>source, bundled, binary, installed</em> und <em>in memory</em>.</p>
<ul>
<li><p><strong>source</strong>: Die source Version eines Pakets besteht aus dem Verzeichnis <code>Paketname</code></p></li>
<li><p><strong>bundled</strong>: Komprimiert man das Verzeichnis in eine <code>.tar.gz</code> Datei so spricht man von einem ‚Äúgeb√ºndelten‚Äù Paket. Dieser Typ stellt eher einen Zwischenschritt dar. Mit <code><a href="https://devtools.r-lib.org/reference/build.html">devtools::build()</a></code> kann aber eine solche Version erzeugt werden. Weitere Unterschiede zu einer source Version sind f√ºr uns erst mal nicht von Interesse.</p></li>
<li><p><strong>binary</strong>: Ein geb√ºndeltes Paket kann von anderen R Nutzern nur installiert werden, wenn sie selbst √ºber die entsprechenden ‚ÄúWerkzeuge‚Äù (Rtools, ‚Ä¶) verf√ºgen. Binary Pakete bestehen auch nur aus einer Datei, k√∂nnen aber von anderen R Nutzern auch ohne weitere ‚ÄúWerkzeuge‚Äù installiert werden. Allerdings sind binary Pakete plattformspezifisch. Ein Windows binary Paket kann also z.B. nicht auf einem Mac installiert werden. Erzeugt wird eine binary Version z.B. mit <code>devtools::build(binary = TRUE)</code>.</p></li>
<li>
<p><strong>installed</strong>: Ein installiertes Paket ist ein in eine R Library entpacktes binary Paket. Zu diesem Zustand kann man √ºber mehrere Wege gelangen, z.B.</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>: CRAN binary -&gt; installed</li>
<li>
<code>install.packages(type = source)</code>: CRAN source -&gt; bundled -&gt; installed</li>
<li>
<code><a href="https://devtools.r-lib.org/reference/install.html">install()</a></code>: source -&gt; installed</li>
</ul>
</li>
</ul>
<p>Mit <code><a href="https://remotes.r-lib.org/reference/install_github.html">devtools::install_github()</a></code> k√∂nnen source Pakete aus eine <a href="https://github.com/">GitHub</a> Projekt installiert werden, und mit <code>devtools::_install_gitlab()</code> aus einem GitLab Projekt.</p>
<ul>
<li>
<strong>in memory</strong>: Will man mit mehreren Funktionen eines Paket arbeiten, sollte es in den Speicher geladen werden. Dies geschieht mit <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> (installierte Pakete) oder <code><a href="https://devtools.r-lib.org/reference/load_all.html">load_all()</a></code> (beim Entwickeln von Paketen).</li>
</ul>
</div>
<div id="description" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> DESCRIPTION<a class="anchor" aria-label="anchor" href="#description"><i class="fas fa-link"></i></a>
</h2>
<p>Die DESCRIPTION Datei enth√§lt Informationen √ºber das Paket und ist ein essentieller Bestandteil jedes Pakets. Der Befehl</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_package.html">create_package</a></span><span class="op">(</span><span class="st">"meinR4EWSpckg"</span><span class="op">)</span></span></code></pre></div>
<p>erzeugt die DESCRIPTION Datei</p>
<pre><code>Package: meinR4EWSpckg
Type: Package
Title: What the Package Does (Title Case)
Version: 0.1.0
Author: Who wrote it
Maintainer: The package maintainer &lt;yourself@somewhere.net&gt;
Description: More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.
License: What license is it under?
Encoding: UTF-8
LazyData: true</code></pre>
<p>im Ordner <code>meinR4EWSpckg</code>.</p>
<p>Die wichtigsten Felder einer DESCRIPTION Datei sind dadurch vorhanden (und m√ºssen gef√ºllt werden). √úber die Punkte <code>Imports</code> und <code>Suggests</code> (nicht automatisch vorhanden) kann festgelegt werden welche anderen R Pakete zwingend notwendig bzw. hilfreich sind f√ºr das eigene Paket.</p>
<p>Pakete in <code>Imports</code> werden beim Installieren des eigenen Pakets ebenfalls installiert, falls diese noch nicht vorhanden sind. Pakete in <code>Suggests</code> werden nicht automatisch installiert.</p>
<p>√úber</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_package.html">use_package</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></span></code></pre></div>
<p>kann z.B. das Paket <code>dplyr</code> dem Punkt <code>Imports</code> hinzugef√ºgt werden. <code>usethis::use_package(type = "Suggests")</code> f√ºgt <code>Suggests</code> weitere Pakete hinzu.</p>
<div id="name-titel-beschreibung" class="section level3" number="12.5.1">
<h3>
<span class="header-section-number">12.5.1</span> Name, Titel, Beschreibung<a class="anchor" aria-label="anchor" href="#name-titel-beschreibung"><i class="fas fa-link"></i></a>
</h3>
<p>Der Name (<code>Package</code>) eines Pakets darf Buchstaben, Zahlen und <code>.</code> enthalten und sollte mit dem Verzeichnisname √ºbereinstimmen.</p>
<p><code>Title</code> und <code>Description</code> sollten beschreiben was das Paket genau macht. <code>Description</code> ist dabei deutlich ausf√ºhrlicher und enth√§lt daher i.d.R. mehrere Zeilen. Nach einem Zeilenumbruch sollte 4 Leerzeichen einger√ºckt werden. Ein Beispiel w√§re</p>
<pre><code>Title: An implementation of the Grammar of Graphics
Description: An implementation of the grammar of graphics in R. 
    It combines the advantages of both base and lattice graphics: 
    conditioning and shared axes are handled automatically, and 
    you can still build up a plot step by step from multiple data 
    sources. It also implements a sophisticated multidimensional 
    conditioning system and a consistent interface to map data 
    to aesthetic attributes. See the ggplot2 website for more 
    information, documentation and examples.</code></pre>
</div>
<div id="autoren" class="section level3" number="12.5.2">
<h3>
<span class="header-section-number">12.5.2</span> Autoren<a class="anchor" aria-label="anchor" href="#autoren"><i class="fas fa-link"></i></a>
</h3>
<p>√úber das Feld <code>Authors@R</code> k√∂nnen die Autoren des Pakets angegeben werden. An dieser Stelle kann
in der DESCRIPTION Datei R Code verwendet werden um die n√∂tigen Informationen</p>
<ul>
<li>
<code>given, family</code>: Vor- und Nachname</li>
<li>
<code>email</code>: E-Mailadresse</li>
<li>
<code>role</code>: Rolle der Person. Wichtige Beispiele sind
<ul>
<li>
<code>cre</code>: Ersteller oder Maintainer</li>
<li>
<code>aut</code>: hat wichtige Beitr√§ge zum Paket erbracht</li>
<li>
<code>ctb</code>: hat kleinere Beitr√§ge zum Paket erbracht</li>
</ul>
</li>
</ul>
<p>Mit der Funktion <code><a href="https://rdrr.io/r/utils/person.html">person()</a></code> k√∂nnen diese Informationen nun angegeben werden</p>
<pre><code>Authors@R: person(given = "Stephan", family = "Haug", 
                  email = "haug@tum.de", 
                  role = c("cre", "aut"))</code></pre>
<p>Der Output von <code><a href="https://rdrr.io/r/utils/person.html">person()</a></code> sieht dann folgenderma√üen aus</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/person.html">person</a></span><span class="op">(</span>given <span class="op">=</span> <span class="st">"Stephan"</span>, family <span class="op">=</span> <span class="st">"Haug"</span>, </span>
<span>                  email <span class="op">=</span> <span class="st">"haug@tum.de"</span>, </span>
<span>                  role <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cre"</span>, <span class="st">"aut"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Stephan Haug &lt;haug@tum.de&gt; [cre, aut]"</code></pre>
</div>
<div id="version" class="section level3" number="12.5.3">
<h3>
<span class="header-section-number">12.5.3</span> Version<a class="anchor" aria-label="anchor" href="#version"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://devtools.r-lib.org/reference/create.html">devtools::create()</a></code> legt die Default-Version auf <code>0.1.0</code> fest. Generell sollte die Versionsnummer aus drei Teilen bestehen und die Form <code>x.y.z</code> haben, wobei <code>x</code> die Nummer f√ºr gr√∂√üere Updates, <code>y</code> die Nummer f√ºr kleinere Updates und <code>z</code> die Nummer f√ºr Korrekturen ist.</p>
<p>Die aktuelle Version von <code>ggplot2</code> ist z.B.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] '3.5.1'</code></pre>
<p>F√ºr Pakete, die sich in der <strong>Entwicklung</strong> befinden, bietet es sich an noch einen vierten Teil anzuf√ºgen und mit der Versionsnummer <code>0.0.0.9000</code> zu starten.</p>
<p>Nach diesen Anpassung k√∂nnte die DESCRIPTION Datei also so aussehen</p>
<pre><code>Package: meinR4EWSpckg
Type: Package
Title: Paket zu R4ews, das ...
Version: 0.0.0.9000
Authors@R: person(given = "Stephan", family = "Haug", 
                  email = "haug@tum.de", 
                  role = c("cre", "aut"))
Description: Paket, das im Rahmen des R Projekts R4ews entstanden ist.
    Das Paket bietet ...
License: What license is it under?
Encoding: UTF-8
LazyData: true
Imports: 
    dplyr</code></pre>
<blockquote>
<p>Der Punkt Lizenz ist f√ºr erstmal nachgeordnet. Wer aber mehr √ºber die Wahl einer passenden Lizenz erfahren m√∂chte, den verweisen wir gerene auf das Kapitel <a href="https://r-pkgs.org/license.html">Licensing</a> in <a href="https://r-pkgs.org">R packages</a>.</p>
</blockquote>
</div>
</div>
<div id="pakete-dokumentation" class="section level2" number="12.6">
<h2>
<span class="header-section-number">12.6</span> Pakete: Dokumentation<a class="anchor" aria-label="anchor" href="#pakete-dokumentation"><i class="fas fa-link"></i></a>
</h2>
<p>Ein wichtiger Teil eines Pakets ist die ausreichende Dokumentation (wichtiger) Funktionen. Dokumentationen werden als <code>.Rd</code> (LaTeX √§hnliches Format) Dateien im Verzeichnis <code>man/</code> abgelegt. Das Paket <code>roxygen2</code> bietet eine komfortable M√∂glichkeit aus Funktionskommentaren (in einem speziellen Format) eine <code>.Rd</code> Datei zu erzeugen.</p>
<p><em>Ablauf:</em></p>
<ol style="list-style-type: decimal">
<li>roxygen Kommentare in die <code>.R</code> Datei einf√ºgen</li>
<li>
<code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> ausf√ºhren um Kommentare in <code>.Rd</code> Datei zu konvertieren</li>
<li>Dokumentation mit <code>?</code> betrachten</li>
<li>gegebenenfalls alles wiederholen</li>
</ol>
<p>roxygen Kommentare beginnen mit <code>#'</code>.</p>
<p>Wir f√ºgen eine Datei <code>add_2.R</code> mit Inhalt</p>
<pre><code>#' Addiere zwei Zahlen
#' 
#' @param x Eine Zahl.
#' @param y Eine Zahl.
#' @return Die Summe von \code{x} und \code{y}.
#' @examples
#' add_2(1, 1)
#' add_2(10, 1)
add_2 &lt;- function(x, y) {
  x + y
}</code></pre>
<p>dem Verzeichnis <code>meinR4EWSpckg/R</code> hinzu.</p>
<p>Der Befehl <code><a href="https://devtools.r-lib.org/reference/document.html">devtools::document()</a></code> (ausgef√ºhrt im Verzeichnis <code>meinR4EWSpckg</code> - source Paket) erzeugt dann die Datei <code>meinR4EWSpckg/man/add_2.Rd</code></p>
<pre><code>% Generated by roxygen2 (4.0.2): do not edit by hand
\name{add_2}
\alias{add_2}
\title{Addiere zwei Zahlen}
\usage{
add_2(x, y)
}
\arguments{
\item{x}{Eine Zahl.}

\item{y}{Eine Zahl.}
}
\value{
Die Summe von \code{x} und \code{y}.
}
\description{
Addiere zwei Zahlen
}
\examples{
add_2(1, 1)
add_2(10, 1)
}
</code></pre>
<p>Alle roxygen Kommentare beginnen mit <code>#'</code> und sind unterteilt in verschiedene Tags der Form <code>@name_tag beschreibung</code>. Vor dem ersten Tag kommen allerdings</p>
<ul>
<li>Titel: erste Zeile des Kommentars</li>
<li>Beschreibung der Funktion: zweiter Abschnitt des Kommentars (l√§nger als Titel)</li>
<li>Details zur Funktion: dritter Abschnitt des Kommentars (l√§nger als die Beschreibung) - optional</li>
</ul>
<p>In unserem Beispiel wurde der Titel auch gleich als Beschreibung (da nicht explizit angegeben) verwendet.</p>
<p>Die drei wichtigsten Tags zum Kommentieren einer Funktion sind: <code>@param, @examples</code> und <code>@return</code>.
Weitere Tags sind im Abschnitt <a href="http://r-pkgs.had.co.nz/man.html#man-functions">Documenting functions</a> des Buchs <a href="https://r-pkgs.org">R packages</a> beschrieben.</p>
<p>Mit den Befehlen <code>\emph{}, \strong{}</code>, <code>\code{}</code> und <code>\pkg{}</code> (Paketname) kann der Text formatiert werden.</p>
<p>Ebenso k√∂nnen Links zu anderen Dokumentationen</p>
<ul>
<li>
<code>\code{\link{function}}</code>: Funktion <code>function</code> im eigenen Paket</li>
<li>
<code>\code{\link[devtools]{load_all}}</code>: Funktionen aus anderen Paketen, hier <code><a href="https://devtools.r-lib.org/reference/load_all.html">devtools::load_all</a></code>
</li>
</ul>
<p>oder dem Netz</p>
<ul>
<li><code>\url{http://rstudio.com}</code></li>
<li><code>\href{http://rstudio.com}{RStudio}</code></li>
<li>
<code>\email{haug@@tum.de}</code> (<code>@@</code> ist n√∂tig, da <code>@</code> f√ºr die Tags reserviert ist)</li>
</ul>
<p>Weitere M√∂glichkeiten der Formatierung findet man im Abschnitt <a href="http://r-pkgs.had.co.nz/man.html#text-formatting">Text formatting</a> des Buch <a href="https://r-pkgs.org">R packages</a>.</p>
</div>
<div id="namespace" class="section level2" number="12.7">
<h2>
<span class="header-section-number">12.7</span> NAMESPACE<a class="anchor" aria-label="anchor" href="#namespace"><i class="fas fa-link"></i></a>
</h2>
<p>Es ist nicht nur f√ºr das Erstellen von Paketen hilfreich das Konzept eines <code>NAMESPACE</code> verstanden zu haben, sondern auch f√ºr das generelle Arbeiten mit R. Man unterscheidet dabei <strong>Import</strong> <code>NAMESPACES</code> und <strong>Export</strong> <code>NAMESPACES</code>.</p>
<p><strong>Import</strong> legt dabei fest wie die Funktion eines Pakets eine Funktion in einem anderen Paket findet. Betrachten wir z.B.</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nrow</span></span></code></pre></div>
<pre><code>## function (x) 
## dim(x)[1L]
## &lt;bytecode: 0x11bdba388&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>Diese Funktion ist definiert in Abh√§ngigkeit von <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> aus dem <code>base</code> Paket.</p>
<p>Auch wenn wir die Funktion</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 1</code></pre>
<p>definieren, findet <code><a href="https://rdrr.io/r/base/nrow.html">nrow()</a></code> trotzdem die ‚Äúrichtige‚Äù Funktion</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<p>da sie den <code>NAMESPACE</code> des <code>base</code> Pakets verwendet.</p>
<p><strong>Export</strong> legt fest welche Funktionen eines Pakets au√üerhalb des Pakets zur Verf√ºgung stehen sollen. Dies m√ºssen/sollten nicht alle Funktionen sein. Ein Paket kann also interne Funktionen haben, die nur intern verwendet werden k√∂nnen.</p>
<p>√úber den Operator <code>::</code> wird explizit auf den NAMESPACE eines Pakets zugegriffen. Auf diese Art und Weise vermeidet man auch Konflikte zwischen Funktionen aus verschiedenen Paketen, die aber den gleichem Namen haben. In einem solchen Fall kommt es darauf an welches Paket zuletzt geladen wurde. Dieses findet man dann zuerst im Suchpfad</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/search.html">search</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] ".GlobalEnv"        "package:devtools"  "package:usethis"  
##  [4] "package:stats"     "package:graphics"  "package:grDevices"
##  [7] "package:utils"     "package:datasets"  "package:methods"  
## [10] "Autoloads"         "package:base"</code></pre>
<p>In der <code>NAMESPACE</code> Datei beschreiben</p>
<ul>
<li>
<code>export()</code>: exportiert Funktionen</li>
<li>
<code>exportPattern()</code>: exportiert alle Funktionen, die zu einem bestimmten Schema passen</li>
<li>
<code>S3method()</code>: exportiert <code>S3</code> Methoden</li>
</ul>
<p>den Export und</p>
<ul>
<li>
<code>import()</code>: importiert alle Funktionen aus einem Paket</li>
<li>
<code>importFrom()</code>: importiert eine bestimmte Funktion aus einem Paket</li>
<li>
<code>useDynLib()</code>: importiert eine Funktion aus C</li>
</ul>
<p>den Import.</p>
<p>Export-Eintr√§ge in der <code>NAMESPACE</code> Datei k√∂nnen leicht √ºber <code>roxygen</code> Kommentare erzeugt werden.
√úber einen <code>@export</code> Tag wird angegeben welche Funktion exportiert werden soll</p>
<pre><code>#' @export
export_function &lt;- function(...){
  ... 
}</code></pre>
<p>Je nach Objekttyp wird dann <code>export(), exportPattern()</code> oder <code>S3method()</code> im <code>NAMESPACE</code> verwendet. Generell sollte man sich an die Regel halten lieber weniger als mehr Funktionen zu exportieren, wenn man das Paket an Dritte weitergeben will.</p>
<p>Beim Importieren sollte man noch restriktiver sein. Man sollte √ºber <code>Imports</code> in der <code>DESCRIPTION</code> Datei sicherstellen, dass alle notwendigen Pakete installiert und geladen sind. Danach kann einfach √ºber den <code>::</code> Operator in eigenen Funktionen auf Funktionen aus anderen geladenen Paketen zugegriffen werden, also z.B. <code>pkg_name::funktion_aus_pkg_name()</code>.</p>
<p>Dies erh√∂ht die sp√§tere Lesbarkeit der eigenen Programme und vermeidet potentielle Konflikte, die beim Importieren mehrerer Pakete - die dann wieder Funktionen mit gleichem Namen besitzen - auftreten k√∂nnen.</p>
<p>Muss eine Funktion h√§ufig verwendet werden - und man will nicht dauernd <code>::</code> verwenden - so sollte man √ºber <code>importFrom()</code> eher nur die Funktion und nicht das ganze Paket importieren.</p>
</div>
<div id="daten-einbinden" class="section level2" number="12.8">
<h2>
<span class="header-section-number">12.8</span> Daten einbinden<a class="anchor" aria-label="anchor" href="#daten-einbinden"><i class="fas fa-link"></i></a>
</h2>
<p>Daten, die das Paket enthalten sollte, legt man im Verzeichnis <code>/data</code> ab. Als Format sollte man <code>.rda</code> w√§hlen (ist aber kein Muss). Der einfachste Weg dies zu ber√ºcksichtigen ist die Funktion <code><a href="https://usethis.r-lib.org/reference/use_data.html">usethis::use_data()</a></code> zu verwenden.</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html">use_data</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p>Dieser Befehl speichert die Objekte <code>x</code> und <code>mtcars</code> in den Dateien <code>data/x.rda</code> und <code>data/mtcars.rda</code> ab. Der Dateiname stimmt also mit dem Objektnamen √ºberein.</p>
<p>Datens√§tze sollten auf jeden Fall dokumentiert werden. Dazu f√ºgt man einfach in eine der <code>.R</code> Dateien im Verzeichnis <code>/R</code> einen weiteren <code>roxygen2</code> Absatz ein. F√ºr das Dokumentieren von Datens√§tzen stehen zwei weitere Tags bereit. √úber <code>@format</code> beschreibt man das genaue Format der Daten, z.B. die einzelnen Spalten eines Data Frames, und mit <code>@source</code> gibt man (falls vorhanden) die Datenquelle an.</p>
<p>Die Beschreibung des Datensatzes <code>x</code> k√∂nnte also z.B. so aussehen</p>
<pre><code>#' Mein Datensatz
#' 
#' Ein Datensatz bestehend aus 50 Zahlen gezogen aus den 
#' Zahlen 1 bis 100 mit Zuruecklegen
#' 
#' @format Ein Integer Vektor der Laenge 50
"x"</code></pre>
</div>
<div id="c-special-topic" class="section level2" number="12.9">
<h2>
<span class="header-section-number">12.9</span> C++ (Special Topic)<a class="anchor" aria-label="anchor" href="#c-special-topic"><i class="fas fa-link"></i></a>
</h2>
<p>Will man in seinem Paket R Funktionen verwenden, die mithilfe von <code>Rcpp</code> aus kompiliertem C++ Code entstanden sind, so sollte man zur Vorbereitung</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_rcpp.html">use_rcpp</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>ausf√ºhren. Danach ist das das Verzeichnis <code>/src</code> angelegt und <code>Rcpp</code> zu den Feldern <code>LinkingTo</code> und <code>Imports</code> in der <code>DESCRIPTION</code> Datei hinzugef√ºgt. Au√üerdem wird man aufgefordert die roxygen Tags</p>
<pre><code>#' @useDynLib meinR4EWSpckg
#' @importFrom Rcpp sourceCpp</code></pre>
<p>in eine der <code>.R</code> Dateien einzuf√ºgen.</p>
<p>Ebenso wie in die <code>.R</code> Dateien kann auch in die <code>.cpp</code> Dateien die roxygen Dokumentation eingef√ºgt werden. Allerdings verwendet man <code>//'</code> statt <code>#'</code>.</p>
<pre><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;

//' Multipliziere eine Zahl mit 2
//' 
//' @param x Ein Integer.
//' @export
// [[Rcpp::export]]
int malZwei(int x) {
   return x * 2;
}</code></pre>
</div>
<div id="git-und-githubgitlab" class="section level2" number="12.10">
<h2>
<span class="header-section-number">12.10</span> Git und GitHub/GitLab<a class="anchor" aria-label="anchor" href="#git-und-githubgitlab"><i class="fas fa-link"></i></a>
</h2>
<p>Jedes Pakete (mag es auch noch so klein sein) sollte unter Verwendung von Git erstellt werden. Beim Anlegen des Projekts (zur Erstellung des Pakets) √ºber RStudio, kann leicht ein lokales Git repository initialisiert werden</p>
<div class="inline-figure">
<img src="img/package_git.png"><!-- -->
</div>
<p>Soll zus√§tzlich ein remote repository verwendet werden, so kann man (im Standardfall) ein neues repository auf GitLab (oder GitHub) anlegen. Es sollte den gleichen Namen bekommen wie das Paket (lokales Git repository). Danach kann man im Terminal Befehle der Form</p>
<pre><code>git remote add origin https://gitlab.lrz.de/vw99xyz/paketName.git
git push -u origin master</code></pre>
<p>ausf√ºhren.</p>
<p>Angenommen es existiert bereits ein remote repository und das Paket soll dort ‚Äúverwaltet‚Äù werden, kann einfach dieses repository geklont werden</p>
<pre><code>git clone https://gitlab.lrz.de/vw99xyz/paketName.git</code></pre>
<p>Danach existiert im Verzeichnis, in dem der Befehl ausgef√ºhrt wurde, das Unterverzeichnis <code>paketName</code>. In R kann anschlie√üend den Befehl</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/create.html">create</a></span><span class="op">(</span><span class="st">"paketName"</span><span class="op">)</span></span></code></pre></div>
<p>ausgef√ºhrt werden (im Verzeichnis, welches das Git repository <code>paketName</code> enth√§lt). Danach sichert man alle √Ñnderungen s √ºber einen commit Befehl</p>
<pre><code>git add .
git commit -m "paket struktur angelegt"</code></pre>
<p>und pusht</p>
<pre><code>git push</code></pre>
</div>
<div id="literatur-2" class="section level2" number="12.11">
<h2>
<span class="header-section-number">12.11</span> Literatur<a class="anchor" aria-label="anchor" href="#literatur-2"><i class="fas fa-link"></i></a>
</h2>
<p>Dieser Abschnitt hat einen kleinen Einblick in das Erstellen eigener Pakete gegeben. Allerdings wurden viele weitere Aspekte nicht angesprochen. Weitere Informationen zu R Paketen findet man z.B. im Buch <a href="http://r-pkgs.had.co.nz/">R packages</a> von Hadley Wickham <span class="citation">(<a href="literatur-3.html#ref-wickham2015b">2015b</a>)</span>.</p>

</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="bausteine.html"><span class="header-section-number">11</span> Bausteine</a></div>
<div class="next"><a href="funktionen.html"><span class="header-section-number">13</span> Funktionen</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#pakete"><span class="header-section-number">12</span> Pakete</a></li>
<li><a class="nav-link" href="#struktur"><span class="header-section-number">12.1</span> Struktur</a></li>
<li><a class="nav-link" href="#c-compiler"><span class="header-section-number">12.2</span> C Compiler</a></li>
<li><a class="nav-link" href="#r-code"><span class="header-section-number">12.3</span> R Code</a></li>
<li><a class="nav-link" href="#verschiedene-typen"><span class="header-section-number">12.4</span> Verschiedene Typen</a></li>
<li>
<a class="nav-link" href="#description"><span class="header-section-number">12.5</span> DESCRIPTION</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#name-titel-beschreibung"><span class="header-section-number">12.5.1</span> Name, Titel, Beschreibung</a></li>
<li><a class="nav-link" href="#autoren"><span class="header-section-number">12.5.2</span> Autoren</a></li>
<li><a class="nav-link" href="#version"><span class="header-section-number">12.5.3</span> Version</a></li>
</ul>
</li>
<li><a class="nav-link" href="#pakete-dokumentation"><span class="header-section-number">12.6</span> Pakete: Dokumentation</a></li>
<li><a class="nav-link" href="#namespace"><span class="header-section-number">12.7</span> NAMESPACE</a></li>
<li><a class="nav-link" href="#daten-einbinden"><span class="header-section-number">12.8</span> Daten einbinden</a></li>
<li><a class="nav-link" href="#c-special-topic"><span class="header-section-number">12.9</span> C++ (Special Topic)</a></li>
<li><a class="nav-link" href="#git-und-githubgitlab"><span class="header-section-number">12.10</span> Git und GitHub/GitLab</a></li>
<li><a class="nav-link" href="#literatur-2"><span class="header-section-number">12.11</span> Literatur</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R4ews MA0009</strong>" was written by Stephan Haug. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
