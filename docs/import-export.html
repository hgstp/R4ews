<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 8 Daten I/O | R4ews MA0009</title>
  <meta name="description" content="R4ews: R Ergänzung zum Modul MA009." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 8 Daten I/O | R4ews MA0009" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R4ews: R Ergänzung zum Modul MA009." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 8 Daten I/O | R4ews MA0009" />
  
  <meta name="twitter:description" content="R4ews: R Ergänzung zum Modul MA009." />
  

<meta name="author" content="Stephan Haug" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr-single.html"/>
<link rel="next" href="literatur.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<html>
  
  <head>
  <script src="anchor-links.js"></script>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-68219208-1"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-68219208-1');
  </script>

  </head>

</html>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Willkommen zur R Ergänzung zur Einführung in die Wahrscheinlichkeitstheorie und Statistik</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#beteiligte-personen"><i class="fa fa-check"></i>Beteiligte Personen</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#kolophon"><i class="fa fa-check"></i>Kolophon</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lizenz"><i class="fa fa-check"></i>Lizenz</a></li>
</ul></li>
<li class="part"><span><b>I R, wie fange ich an</b></span></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> Installieren von R und RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html#r-und-rstudio"><i class="fa fa-check"></i><b>1.1</b> R und RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="install.html"><a href="install.html#funktioniert-ausprobieren"><i class="fa fa-check"></i><b>1.2</b> Funktioniert? Ausprobieren</a></li>
<li class="chapter" data-level="1.3" data-path="install.html"><a href="install.html#add-on-packages"><i class="fa fa-check"></i><b>1.3</b> Add-on packages</a></li>
<li class="chapter" data-level="1.4" data-path="install.html"><a href="install.html#rstudio-primers"><i class="fa fa-check"></i><b>1.4</b> RStudio Primers</a></li>
<li class="chapter" data-level="1.5" data-path="install.html"><a href="install.html#aufgabe"><i class="fa fa-check"></i><b>1.5</b> Aufgabe</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R Basics und Arbeitsabläufe</a><ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#ein-paar-grundlagen-für-das-arbeiten-mit-r"><i class="fa fa-check"></i><b>2.1</b> Ein paar Grundlagen für das Arbeiten mit R</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#workspace-und-working-directory"><i class="fa fa-check"></i><b>2.2</b> Workspace und working directory</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-basics.html"><a href="r-basics.html#workspace-.rdata"><i class="fa fa-check"></i><b>2.2.1</b> Workspace, <code>.RData</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="r-basics.html"><a href="r-basics.html#working-directory"><i class="fa fa-check"></i><b>2.2.2</b> Working directory</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#rprojs"><i class="fa fa-check"></i><b>2.3</b> RStudio Projects</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#zuletzt-noch"><i class="fa fa-check"></i><b>2.4</b> Zuletzt noch</a></li>
</ul></li>
<li class="part"><span><b>II Versionskontrolle und R Markdown</b></span></li>
<li class="chapter" data-level="3" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>3</b> Git, GitHub, and RStudio</a></li>
<li class="chapter" data-level="4" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>4</b> R Markdown</a></li>
<li class="part"><span><b>III Datenanalyse Teil 1</b></span></li>
<li class="chapter" data-level="5" data-path="basic-data-care.html"><a href="basic-data-care.html"><i class="fa fa-check"></i><b>5</b> Letzte Vorbereitungen …</a><ul>
<li class="chapter" data-level="5.1" data-path="basic-data-care.html"><a href="basic-data-care.html#data-frames-sind-fantastisch"><i class="fa fa-check"></i><b>5.1</b> Data Frames sind fantastisch</a></li>
<li class="chapter" data-level="5.2" data-path="basic-data-care.html"><a href="basic-data-care.html#gapminder-data"><i class="fa fa-check"></i><b>5.2</b> Gapminder data</a></li>
<li class="chapter" data-level="5.3" data-path="basic-data-care.html"><a href="basic-data-care.html#die-gapminder-daten-sind-ein-tibble"><i class="fa fa-check"></i><b>5.3</b> Die <code>gapminder</code> Daten sind ein “tibble”</a></li>
<li class="chapter" data-level="5.4" data-path="basic-data-care.html"><a href="basic-data-care.html#variablen-in-einem-data-frame"><i class="fa fa-check"></i><b>5.4</b> Variablen in einem Data Frame</a></li>
<li class="chapter" data-level="5.5" data-path="basic-data-care.html"><a href="basic-data-care.html#recap"><i class="fa fa-check"></i><b>5.5</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr-intro.html"><a href="dplyr-intro.html"><i class="fa fa-check"></i><b>6</b> Einführung in dplyr</a><ul>
<li class="chapter" data-level="6.1" data-path="dplyr-intro.html"><a href="dplyr-intro.html#einstieg"><i class="fa fa-check"></i><b>6.1</b> Einstieg</a><ul>
<li class="chapter" data-level="6.1.1" data-path="dplyr-intro.html"><a href="dplyr-intro.html#wie-immer-laden-wir-zu-beginn-tidyverse"><i class="fa fa-check"></i><b>6.1.1</b> Wie immer, laden wir zu Beginn <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="dplyr-intro.html"><a href="dplyr-intro.html#filter-indizieren-von-zeilen"><i class="fa fa-check"></i><b>6.2</b> <code>filter()</code>: Indizieren von Zeilen</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr-intro.html"><a href="dplyr-intro.html#der-pipe-operator"><i class="fa fa-check"></i><b>6.3</b> Der Pipe-Operator</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr-intro.html"><a href="dplyr-intro.html#mit-select-variablen-auswählen"><i class="fa fa-check"></i><b>6.4</b> Mit <code>select()</code> Variablen auswählen</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr-intro.html"><a href="dplyr-intro.html#jetzt-nochmal-ein-vergleich-zu-r-standardbefehlen"><i class="fa fa-check"></i><b>6.5</b> Jetzt nochmal ein Vergleich zu R Standardbefehlen</a></li>
<li class="chapter" data-level="6.6" data-path="dplyr-intro.html"><a href="dplyr-intro.html#pure-predictable-pipeable"><i class="fa fa-check"></i><b>6.6</b> Pure, predictable, pipeable</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dplyr-single.html"><a href="dplyr-single.html"><i class="fa fa-check"></i><b>7</b> Mehr zu <code>dplyr</code></a><ul>
<li class="chapter" data-level="7.1" data-path="dplyr-single.html"><a href="dplyr-single.html#wo-stehen-wir"><i class="fa fa-check"></i><b>7.1</b> Wo stehen wir?</a></li>
<li class="chapter" data-level="7.2" data-path="dplyr-single.html"><a href="dplyr-single.html#falls-noch-nicht-geschehen-lade-dplyr-und-gapminder"><i class="fa fa-check"></i><b>7.2</b> Falls noch nicht geschehen: lade <code>dplyr</code> und <code>gapminder</code></a></li>
<li class="chapter" data-level="7.3" data-path="dplyr-single.html"><a href="dplyr-single.html#mitmutate-neue-variablen-erstellen"><i class="fa fa-check"></i><b>7.3</b> Mit<code>mutate()</code> neue Variablen erstellen</a></li>
<li class="chapter" data-level="7.4" data-path="dplyr-single.html"><a href="dplyr-single.html#mit-arrange-die-zeilenreihenfolge-ändern"><i class="fa fa-check"></i><b>7.4</b> Mit <code>arrange()</code> die Zeilenreihenfolge ändern</a></li>
<li class="chapter" data-level="7.5" data-path="dplyr-single.html"><a href="dplyr-single.html#mit-rename-schöne-namen-vergeben"><i class="fa fa-check"></i><b>7.5</b> Mit <code>rename()</code> “schöne” Namen vergeben</a></li>
<li class="chapter" data-level="7.6" data-path="dplyr-single.html"><a href="dplyr-single.html#group_by-macht-das-r-leben-einfacher"><i class="fa fa-check"></i><b>7.6</b> <code>group_by()</code> macht das R Leben einfacher</a><ul>
<li class="chapter" data-level="7.6.1" data-path="dplyr-single.html"><a href="dplyr-single.html#die-dinge-aufzählen"><i class="fa fa-check"></i><b>7.6.1</b> Die Dinge aufzählen</a></li>
<li class="chapter" data-level="7.6.2" data-path="dplyr-single.html"><a href="dplyr-single.html#deskriptive-statistiken-mit-summarise"><i class="fa fa-check"></i><b>7.6.2</b> Deskriptive Statistiken mit <code>summarise()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="dplyr-single.html"><a href="dplyr-single.html#gruppierte-veränderungen"><i class="fa fa-check"></i><b>7.7</b> Gruppierte Veränderungen</a><ul>
<li class="chapter" data-level="7.7.1" data-path="dplyr-single.html"><a href="dplyr-single.html#berechnungen-innerhalb-der-gruppen"><i class="fa fa-check"></i><b>7.7.1</b> Berechnungen innerhalb der Gruppen</a></li>
<li class="chapter" data-level="7.7.2" data-path="dplyr-single.html"><a href="dplyr-single.html#window-functions"><i class="fa fa-check"></i><b>7.7.2</b> Window Funktionen</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="dplyr-single.html"><a href="dplyr-single.html#großes-finale"><i class="fa fa-check"></i><b>7.8</b> Großes Finale</a></li>
<li class="chapter" data-level="7.9" data-path="dplyr-single.html"><a href="dplyr-single.html#weiteres-material"><i class="fa fa-check"></i><b>7.9</b> Weiteres Material</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="import-export.html"><a href="import-export.html"><i class="fa fa-check"></i><b>8</b> Daten I/O</a><ul>
<li class="chapter" data-level="8.1" data-path="import-export.html"><a href="import-export.html#überblick"><i class="fa fa-check"></i><b>8.1</b> Überblick</a><ul>
<li class="chapter" data-level="8.1.1" data-path="import-export.html"><a href="import-export.html#daten-import"><i class="fa fa-check"></i><b>8.1.1</b> Daten Import</a></li>
<li class="chapter" data-level="8.1.2" data-path="import-export.html"><a href="import-export.html#daten-export"><i class="fa fa-check"></i><b>8.1.2</b> Daten Export</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="import-export.html"><a href="import-export.html#load-the-tidyverse"><i class="fa fa-check"></i><b>8.2</b> Load the tidyverse</a></li>
<li class="chapter" data-level="8.3" data-path="import-export.html"><a href="import-export.html#einlesen-der-gapminder-daten"><i class="fa fa-check"></i><b>8.3</b> Einlesen der Gapminder Daten</a></li>
<li class="chapter" data-level="8.4" data-path="import-export.html"><a href="import-export.html#einlesen-von-daten-in-tabellenform"><i class="fa fa-check"></i><b>8.4</b> Einlesen von Daten in Tabellenform</a></li>
<li class="chapter" data-level="8.5" data-path="import-export.html"><a href="import-export.html#daten-exportieren"><i class="fa fa-check"></i><b>8.5</b> Daten exportieren</a></li>
<li class="chapter" data-level="8.6" data-path="import-export.html"><a href="import-export.html#daten-über-eine-api"><i class="fa fa-check"></i><b>8.6</b> Daten über eine API</a><ul>
<li class="chapter" data-level="8.6.1" data-path="import-export.html"><a href="import-export.html#einführung"><i class="fa fa-check"></i><b>8.6.1</b> Einführung</a></li>
<li class="chapter" data-level="8.6.2" data-path="import-export.html"><a href="import-export.html#erstellen-von-api-anforderungen-in-r"><i class="fa fa-check"></i><b>8.6.2</b> Erstellen von API-Anforderungen in R</a></li>
<li class="chapter" data-level="8.6.3" data-path="import-export.html"><a href="import-export.html#unsere-erste-api-anfrage-stellen"><i class="fa fa-check"></i><b>8.6.3</b> Unsere erste API-Anfrage stellen</a></li>
<li class="chapter" data-level="8.6.4" data-path="import-export.html"><a href="import-export.html#get-ausgabe"><i class="fa fa-check"></i><b>8.6.4</b> <code>GET()</code> Ausgabe</a></li>
<li class="chapter" data-level="8.6.5" data-path="import-export.html"><a href="import-export.html#handling-json-data"><i class="fa fa-check"></i><b>8.6.5</b> Handling JSON Data</a></li>
<li class="chapter" data-level="8.6.6" data-path="import-export.html"><a href="import-export.html#apis-und-abfrageparameter"><i class="fa fa-check"></i><b>8.6.6</b> APIs und Abfrageparameter</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="dplyr-single.html"><a href="dplyr-single.html#weiteres-material"><i class="fa fa-check"></i><b>8.7</b> Weiteres Material</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#license">
    License: CC-BY-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R4ews MA0009</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="import-export" class="section level1">
<h1><span class="header-section-number">Kapitel 8</span> Daten I/O</h1>
<div id="überblick" class="section level2">
<h2><span class="header-section-number">8.1</span> Überblick</h2>
<p>Wir haben die Gapminder-Daten als tibble aus dem <a href="https://github.com/jennybc/gapminder">gapminder</a> Paket geladen. Wir haben im letzten Abschnitt weder Daten noch abgeleitete Ergebnisse explizit in eine Datei geschrieben. Im wirklichen Leben wirst du aber ständig Daten, die in Tabellenform vorliegen, in R ein- und auslesen. Manchmal muss das sogar für Daten geschehen, die nicht in Tabellenform vorliegen.</p>
<p>Wie macht man das? Worauf muss man aufpassen?</p>
<div id="daten-import" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Daten Import</h3>
<p>Für den Daten Import gibt es im Allgemeinen zwei Möglichkeiten:</p>
<ul>
<li><em>“Überrasche mich!”</em> Diese Haltung musst du einnehmen, wenn du zum ersten Mal einen Datensatz erhältst. Du musst einfach froh, wenn du die Daten ohne Fehler importieren konntest. Dann schaust du dir das Ergebnis an, entdeckst Fehler in den Daten und/oder beim Import. Du behebst sie und beginnst nochmal von vorne.</li>
<li><em>“Ein weiterer Tag im Paradies.”</em> Das ist die Einstellung, wenn du einen aufgeräumten Datensatz einliest, den du vorher in einem oder mehreren Reinigungsskripten wahnsinnig aufgeräumt haben. Es sollte keine Überraschungen geben.</li>
</ul>
<p>Im zweiten Fall, und im weiteren Verlauf des ersten Falles, lernst du tatsächlich eine Menge darüber, wie die Daten sind/sein sollten. Ein wichtiger Import-Ratschlag: <strong>Verwende die Argumente der Importfunktion, um so weit wie möglich und so schnell wie möglich zu kommen</strong>. Anfängercode hat oft eine Menge unnötigen nachträglichen Aufwand. Lese die Hilfe zu den Importfunktionen und nutzen die Argumente maximal aus, um den Import zu steuern.</p>
</div>
<div id="daten-export" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Daten Export</h3>
<p>Es wird viele Gelegenheiten geben, bei denen du Daten aus R exportieren willst. Zwei wichtige Beispiele:</p>
<ul>
<li>einen gesäuberten Datensatz der bereit ist analysiert zu werden, den du heldenhaft aus recht unordentlichen Daten erstellt hast</li>
<li>ein numerisches Ergebnis aus einer Datenaggregation oder Modellierung oder einer statistischen Schlussfolgerung</li>
</ul>
<p>Erster Tipp: <strong>Der Output von heute ist der Input von morgen</strong>. Denke an all die Schmerzen zurück, die du selbst beim Import von fremden Daten erlitten hast, und fügen dir nicht selbst solche Schmerzen zu!</p>
<p>Zweiter Tipp: Sei nicht zu clever. Eine einfache Textdatei, die von einem Menschen in einem Texteditor lesbar ist, sollte dein Standard sein, bis du <strong>einen guten Grund</strong> dafür hast, dass dies nicht funktionieren wird. Das Lesen und Schreiben in exotische Formate wird das erste sein, was in Zukunft oder auf einem anderen Computer kaputtgehen wird. Es schafft auch Barrieren für jeden, der ein anderes Toolkit hat als du. Strebe nach Zukunfts- und Idiotensicherheit.</p>
<p>Wie passt das zu unserer Betonung der dynamischen Berichterstattung über R Markdown? Es gibt für alles eine Zeit und einen Ort. Es gibt Projekte und Dokumente, bei denen du dich intensiv mit <a href="https://github.com/yihui/knitr">knitr</a> und <a href="https://rmarkdown.rstudio.com/">rmarkdown</a> beschäftigen kannst/willst/musst. Aber es gibt viele gute Gründe, warum (Teile von) einer Analyse nicht (nur) in einen dynamischen Bericht eingebettet werden sollten. Vielleicht bist du gerade dabei Daten zu bereinigen, um einen Datensatz für eine nachfolgende Analyse zu erzeugen. Vielleicht leistet du einen kleinen, aber entscheidenden Beitrag zu einem gigantischen Multi-Autoren-Papier. Etc. Denke auch daran, dass es natürlich auch noch andere Werkzeuge und Arbeitsabläufe gibt, um etwas reproduzierbar zu machen: z.B. <a href="https://kbroman.org/minimal_make/">make</a>.</p>
</div>
</div>
<div id="load-the-tidyverse" class="section level2">
<h2><span class="header-section-number">8.2</span> Load the tidyverse</h2>
<p>Das Hauptpaket, das wir verwenden werden, ist <a href="https://readr.tidyverse.org">readr</a>, welches Alternativen zu den Standardfunktionen <code>read.table()</code> und <code>write.table()</code> bietet. Trotzdem laden wir standardmäßig einfach wieder <a href="https://tidyverse.tidyverse.org">tidyverse</a>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="import-export.html#cb90-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb90-2"><a href="import-export.html#cb90-2"></a><span class="co">#&gt; ── Attaching packages ─────────────────────────────────────────── tidyverse 1.3.0 ──</span></span>
<span id="cb90-3"><a href="import-export.html#cb90-3"></a><span class="co">#&gt; ✓ ggplot2 3.3.2     ✓ purrr   0.3.4</span></span>
<span id="cb90-4"><a href="import-export.html#cb90-4"></a><span class="co">#&gt; ✓ tibble  3.0.3     ✓ dplyr   1.0.2</span></span>
<span id="cb90-5"><a href="import-export.html#cb90-5"></a><span class="co">#&gt; ✓ tidyr   1.1.2     ✓ stringr 1.4.0</span></span>
<span id="cb90-6"><a href="import-export.html#cb90-6"></a><span class="co">#&gt; ✓ readr   1.3.1     ✓ forcats 0.5.0</span></span>
<span id="cb90-7"><a href="import-export.html#cb90-7"></a><span class="co">#&gt; ── Conflicts ────────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb90-8"><a href="import-export.html#cb90-8"></a><span class="co">#&gt; x dplyr::filter() masks stats::filter()</span></span>
<span id="cb90-9"><a href="import-export.html#cb90-9"></a><span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
</div>
<div id="einlesen-der-gapminder-daten" class="section level2">
<h2><span class="header-section-number">8.3</span> Einlesen der Gapminder Daten</h2>
<p>Die Gapminder Daten könnten wir natürlich wie zuvor über das Laden des <code>gapminder</code> Pakets verfügbar machen. Da es in diesem Abschnitt aber um das Einlesen von Daten geht, versuchen wir die Daten als <code>.tsv</code> Datei (tab-separated values - so sind sie im Paket gespeichert) einzulesen. Aber dies bedeutet natürlich, dass wir die entsprechende <code>.tsv</code> Datei erst mal finden müssen. Dabei hilft uns glücklicherweise das <a href="https://fs.r-lib.org/index.html">fs</a> Paket.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="import-export.html#cb91-1"></a><span class="kw">library</span>(fs)</span>
<span id="cb91-2"><a href="import-export.html#cb91-2"></a>(gap_tsv &lt;-<span class="st"> </span><span class="kw">path_package</span>(<span class="st">&quot;gapminder&quot;</span>, <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;gapminder.tsv&quot;</span>))</span>
<span id="cb91-3"><a href="import-export.html#cb91-3"></a><span class="co">#&gt; /Users/hgstp/Library/R/4.0/library/gapminder/extdata/gapminder.tsv</span></span></code></pre></div>
<p>Nachdem wir jetzt den Speicherort der Datei kennen, können wir versuchen sie einzulesen.</p>
</div>
<div id="einlesen-von-daten-in-tabellenform" class="section level2">
<h2><span class="header-section-number">8.4</span> Einlesen von Daten in Tabellenform</h2>
<p>Die Haupt-Funktion zum Einlesen von Daten in readr ist <code>read_delim()</code>. Hier verwenden wir eine Variante, <code>read_tsv()</code>, für tabulatorgetrennte Daten:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="import-export.html#cb92-1"></a>gapminder &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(gap_tsv)</span>
<span id="cb92-2"><a href="import-export.html#cb92-2"></a><span class="co">#&gt; Parsed with column specification:</span></span>
<span id="cb92-3"><a href="import-export.html#cb92-3"></a><span class="co">#&gt; cols(</span></span>
<span id="cb92-4"><a href="import-export.html#cb92-4"></a><span class="co">#&gt;   country = col_character(),</span></span>
<span id="cb92-5"><a href="import-export.html#cb92-5"></a><span class="co">#&gt;   continent = col_character(),</span></span>
<span id="cb92-6"><a href="import-export.html#cb92-6"></a><span class="co">#&gt;   year = col_double(),</span></span>
<span id="cb92-7"><a href="import-export.html#cb92-7"></a><span class="co">#&gt;   lifeExp = col_double(),</span></span>
<span id="cb92-8"><a href="import-export.html#cb92-8"></a><span class="co">#&gt;   pop = col_double(),</span></span>
<span id="cb92-9"><a href="import-export.html#cb92-9"></a><span class="co">#&gt;   gdpPercap = col_double()</span></span>
<span id="cb92-10"><a href="import-export.html#cb92-10"></a><span class="co">#&gt; )</span></span>
<span id="cb92-11"><a href="import-export.html#cb92-11"></a><span class="kw">glimpse</span>(gapminder)</span>
<span id="cb92-12"><a href="import-export.html#cb92-12"></a><span class="co">#&gt; Rows: 1,704</span></span>
<span id="cb92-13"><a href="import-export.html#cb92-13"></a><span class="co">#&gt; Columns: 6</span></span>
<span id="cb92-14"><a href="import-export.html#cb92-14"></a><span class="co">#&gt; $ country   &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;,…</span></span>
<span id="cb92-15"><a href="import-export.html#cb92-15"></a><span class="co">#&gt; $ continent &lt;chr&gt; &quot;Asia&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;As…</span></span>
<span id="cb92-16"><a href="import-export.html#cb92-16"></a><span class="co">#&gt; $ year      &lt;dbl&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997,…</span></span>
<span id="cb92-17"><a href="import-export.html#cb92-17"></a><span class="co">#&gt; $ lifeExp   &lt;dbl&gt; 28.8, 30.3, 32.0, 34.0, 36.1, 38.4, 39.9, 40.8, 41.7, 41.8,…</span></span>
<span id="cb92-18"><a href="import-export.html#cb92-18"></a><span class="co">#&gt; $ pop       &lt;dbl&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 1…</span></span>
<span id="cb92-19"><a href="import-export.html#cb92-19"></a><span class="co">#&gt; $ gdpPercap &lt;dbl&gt; 779, 821, 853, 836, 740, 786, 978, 852, 649, 635, 727, 975,…</span></span></code></pre></div>
<p>Über den Tabulator Spalten in einer Datentabelle zu trennen, ist natürlich nur eine Variante neben weiteren Alternativen wie Komma, Strichpunkt, Leerzeichen, …</p>
<p>Für Komma getrennte Daten würde man beispielsweise <code>read_csv()</code> verwenden. Für volle Flexibilität bei der Angabe des Trennzeichens kannst du aber jederzeit direkt <code>read_delim()</code> verwenden.</p>
<p>Der auffälligste Unterschied zwischen den readr-Funktionen und der Standardfunktion <code>read.table()</code>ist, dass readr standardmäßig Characters NICHT in Faktoren umwandelt. Im Großen und Ganzen ist dies ein besseres Standardverhalten, obwohl es natürlich immer wieder vorkommen wird, dass du einzelne Variablen nach dem Einlesen in einen Faktoren umwandeln wirst. Aber lass dich davon nicht täuschen - im Allgemeinen wirst du durch die Verwendung von readr nach dem Einlesen weniger Anpassungen machen müssen im Vergleich zum Standardvorgehen.</p>
<blockquote>
<p>Fazit: Benutze <code>readr::read_delim()</code> und “Freunde”.</p>
</blockquote>
<p>Die Gapminder-Daten sind zu sauber und einfach, um die großartigen Funktionen von readr zur Geltung zu bringen. Ein Blick in <a href="https://cloud.r-project.org/web/packages/readr/vignettes/readr.html">Introduction to readr</a> zeigt aber noch viele weitere Anpassungsmöglichkeiten der readr Funktionen.</p>
</div>
<div id="daten-exportieren" class="section level2">
<h2><span class="header-section-number">8.5</span> Daten exportieren</h2>
<p>Bevor wir etwas exportieren können, müssen (das ist natürlich so nicht richtig - niemand zwingt uns dazu) etwas berechnen, das es wert ist, exportiert zu werden. Lass uns eine Zusammenfassung der maximalen Lebenserwartung auf Länderebene erstellen.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="import-export.html#cb93-1"></a>gap_life_exp &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span></span>
<span id="cb93-2"><a href="import-export.html#cb93-2"></a><span class="st">  </span><span class="kw">group_by</span>(country, continent) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb93-3"><a href="import-export.html#cb93-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">life_exp =</span> <span class="kw">max</span>(lifeExp)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb93-4"><a href="import-export.html#cb93-4"></a><span class="st">  </span><span class="kw">ungroup</span>()</span>
<span id="cb93-5"><a href="import-export.html#cb93-5"></a><span class="co">#&gt; `summarise()` regrouping output by &#39;country&#39; (override with `.groups` argument)</span></span>
<span id="cb93-6"><a href="import-export.html#cb93-6"></a>gap_life_exp</span>
<span id="cb93-7"><a href="import-export.html#cb93-7"></a><span class="co">#&gt; # A tibble: 142 x 3</span></span>
<span id="cb93-8"><a href="import-export.html#cb93-8"></a><span class="co">#&gt;    country     continent life_exp</span></span>
<span id="cb93-9"><a href="import-export.html#cb93-9"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt;</span></span>
<span id="cb93-10"><a href="import-export.html#cb93-10"></a><span class="co">#&gt;  1 Afghanistan Asia          43.8</span></span>
<span id="cb93-11"><a href="import-export.html#cb93-11"></a><span class="co">#&gt;  2 Albania     Europe        76.4</span></span>
<span id="cb93-12"><a href="import-export.html#cb93-12"></a><span class="co">#&gt;  3 Algeria     Africa        72.3</span></span>
<span id="cb93-13"><a href="import-export.html#cb93-13"></a><span class="co">#&gt;  4 Angola      Africa        42.7</span></span>
<span id="cb93-14"><a href="import-export.html#cb93-14"></a><span class="co">#&gt;  5 Argentina   Americas      75.3</span></span>
<span id="cb93-15"><a href="import-export.html#cb93-15"></a><span class="co">#&gt;  6 Australia   Oceania       81.2</span></span>
<span id="cb93-16"><a href="import-export.html#cb93-16"></a><span class="co">#&gt;  7 Austria     Europe        79.8</span></span>
<span id="cb93-17"><a href="import-export.html#cb93-17"></a><span class="co">#&gt;  8 Bahrain     Asia          75.6</span></span>
<span id="cb93-18"><a href="import-export.html#cb93-18"></a><span class="co">#&gt;  9 Bangladesh  Asia          64.1</span></span>
<span id="cb93-19"><a href="import-export.html#cb93-19"></a><span class="co">#&gt; 10 Belgium     Europe        79.4</span></span>
<span id="cb93-20"><a href="import-export.html#cb93-20"></a><span class="co">#&gt; # … with 132 more rows</span></span></code></pre></div>
<p>Das <code>gap_life_exp</code> data frame ist ein Beispiel für ein Zwischenergebnis, das wir für die Zukunft und für nachgelagerte Analysen oder Visualisierungen speichern wollen.</p>
<p>Die Haupt-Exportfunktion in readr ist <code>write_delim()</code>. Für verschiedene Dateiformate gibt es auch hier wieder verschiedene Komfortfunktionen. Lass uns <code>write_csv()</code> benutzen, um eine kommagetrennte Datei zu erhalten.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="import-export.html#cb94-1"></a><span class="kw">write_csv</span>(gap_life_exp, <span class="st">&quot;gap_life_exp.csv&quot;</span>)</span></code></pre></div>
<p>Schauen wir uns die ersten paar Zeilen von <code>gap_life_exp.csv</code> an. Dazu kannst du entweder die Datei öffnen oder, im Terminal, <code>head</code> darauf anwenden.</p>
<pre><code>country,continent,life_exp
Afghanistan,Asia,43.828
Albania,Europe,76.423
Algeria,Africa,72.301
Angola,Africa,42.731
Argentina,Americas,75.32</code></pre>
<p>Das sieht recht ordentlich aus, obwohl es keine sichtbare Ausrichtung oder Trennung in Spalten gibt. Hätten wir die Basisfunktion <code>read.csv()</code> benutzt, würden wir Zeilennamen und viele Anführungszeichen sehen, es sei denn, wir hätten diese Features explizit abgeschaltet. Das schönere Standardverhalten ist daher der Hauptgrund, warum wir <code>readr::write_csv()</code> gegenüber <code>write.csv()</code> bevorzugen.</p>
<blockquote>
<p>Es ist nicht wirklich fair, sich über den Mangel an sichtbarer Ausrichtung zu beklagen, schließlich erzeugen wir Dateien, die der Computer lesen soll. Falls du wirklich in der Datei “herumstöbern” willst, benutze <code>View()</code> in RStudio oder öffnen die Datei mit einem Spreadsheet Programm (!). Aber erliege NIE der Versuchung, dort Datenmanipulationen vorzunehmen … gehe zurück zu R und schreibe dort die Befehle, die du die nächsten 15 Mal ausführen kannst, wenn du diesen Datensatz (oder Datensätze derselben Form) importieren/bereinigen/aggregieren/exportieren willst.</p>
</blockquote>
</div>
<div id="daten-über-eine-api" class="section level2">
<h2><span class="header-section-number">8.6</span> Daten über eine API</h2>
<p>Interessante Datensätze sind der Treibstoff für ein gutes Data Science Projekt. APIs (Application Programming Interface) sind eine weitere sehr nützliche Methode, um auf interessante Daten zuzugreifen.</p>
<p>Anstatt einen Datensatz herunterladen zu müssen, ermöglichen APIs Daten direkt von bestimmten Websites über eine Schnittstelle anzufordern. Viele große Webseiten wie Twitter und Facebook ermöglichen über APIs den Zugriff auf Teile ihrer Daten.</p>
<p>Wir werden die Grundlagen des Zugriffs auf eine API besprechen. Dazu benötigst du aber keine Vorwissen bzgl. APIs.</p>
<div id="einführung" class="section level3">
<h3><span class="header-section-number">8.6.1</span> Einführung</h3>
<p>API ist ein allgemeiner Begriff für den Ort, an dem ein Computerprogramm mit einem anderen oder mit sich selbst interagiert. Wir sprechen über Web-APIs, bei denen zwei verschiedene Computer - ein Client und ein Server - miteinander interagieren, um Daten anzufordern bzw. bereitzustellen.</p>
<p>APIs bieten eine ausgefeilte Möglichkeit Daten von einer Website anzufordern. Wenn eine Website wie Twitter eine API einrichtet, richten sie im Wesentlichen einen Computer ein, der auf Datenanfragen wartet.</p>
<p>Sobald dieser Computer eine Datenanforderung empfängt, verarbeitet er die Daten selbst und sendet sie an den Computer, der sie angefordert hat. Unsere Aufgabe als Anforderer der Daten wird es sein R Code zu schreiben, der die Anforderung erstellt und dem Computer, auf dem die API läuft, mitteilt, was wir benötigen. Dieser Computer liest dann unseren Code, verarbeitet die Anfrage und gibt schön formatierte Daten zurück, die mithilfe existierender R Pakete verarbeitet werden können..</p>
</div>
<div id="erstellen-von-api-anforderungen-in-r" class="section level3">
<h3><span class="header-section-number">8.6.2</span> Erstellen von API-Anforderungen in R</h3>
<p>Um mit APIs in R zu arbeiten, müssen wir ein paar neue Pakete laden (und vorher natürlich installieren). Konkret werden wir mit den Paketen <code>httr</code> und <code>jsonlite</code> arbeiten. Sie spielen bei der Einbindung der APIs unterschiedliche Rollen, aber beide sind unverzichtbar.</p>
<p>Vermutlich hast du die beiden Pakete bisher nicht installiert. Daher ist der erste Schritt die beiden Pakete zu installieren</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="import-export.html#cb96-1"></a><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;httr&quot;</span>, <span class="st">&quot;jsonlite&quot;</span>))</span></code></pre></div>
<p>und anschließend zu laden</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="import-export.html#cb97-1"></a><span class="kw">library</span>(httr)</span>
<span id="cb97-2"><a href="import-export.html#cb97-2"></a><span class="kw">library</span>(jsonlite)</span>
<span id="cb97-3"><a href="import-export.html#cb97-3"></a><span class="co">#&gt; </span></span>
<span id="cb97-4"><a href="import-export.html#cb97-4"></a><span class="co">#&gt; Attaching package: &#39;jsonlite&#39;</span></span>
<span id="cb97-5"><a href="import-export.html#cb97-5"></a><span class="co">#&gt; The following object is masked from &#39;package:purrr&#39;:</span></span>
<span id="cb97-6"><a href="import-export.html#cb97-6"></a><span class="co">#&gt; </span></span>
<span id="cb97-7"><a href="import-export.html#cb97-7"></a><span class="co">#&gt;     flatten</span></span></code></pre></div>
</div>
<div id="unsere-erste-api-anfrage-stellen" class="section level3">
<h3><span class="header-section-number">8.6.3</span> Unsere erste API-Anfrage stellen</h3>
<p>Der erste Schritt, um Daten von einer API zu erhalten, ist die eigentliche Anfrage in R. Diese Anfrage wird an den Computer-Server geschickt, der über die API verfügt, und wenn alles reibungslos verläuft, wird er eine Antwort zurücksenden.</p>
<p>Es gibt verschiedene Arten von Anfragen, die man an einen API-Server stellen kann. Diese Arten von Anfragen entsprechen verschiedenen Aktionen, die der Server ausführen soll.</p>
<p>Für unsere Zwecke fragen wir lediglich nach Daten, was einer GET-Anfrage entspricht. Andere Arten von Anfragen sind z.B. POST und PUT, aber diese sind für uns nicht von Interesse und daher brauchen wir uns darum nicht zu kümmern.</p>
<p>Um eine GET-Anfrage zu erstellen, müssen wir die <code>GET()</code> Funktion aus dem <code>httr</code> Paket verwenden. Die <code>GET()</code> Funktion benötigt als Input eine URL, die die Adresse des Servers angibt, an den die Anforderung gesendet werden soll.</p>
<p>Als Beispiel werden wir mit der Open Notify API arbeiten, die Daten zu verschiedenen NASA-Projekten enthält. Mithilfe der Open Notify API können wir uns über den Standort der Internationalen Raumstation informieren und erfahren, wie viele Personen sich derzeit im Weltraum aufhalten.</p>
<p>Wir beginnen damit, dass wir unsere Anfrage mit der <code>GET()</code> Funktion stellen und die URL der API angeben:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="import-export.html#cb98-1"></a>jdata &lt;-<span class="st"> </span><span class="kw">GET</span>(<span class="st">&quot;http://api.open-notify.org/astros.json&quot;</span>)</span></code></pre></div>
<p>Die Ausgabe der Funktion <code>GET()</code> ist eine Liste, die alle Informationen enthält, die vom API-Server zurückgegeben werden.</p>
</div>
<div id="get-ausgabe" class="section level3">
<h3><span class="header-section-number">8.6.4</span> <code>GET()</code> Ausgabe</h3>
<p>Schauen wir uns einmal an, wie die Variable jdata in der R-Konsole aussieht:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="import-export.html#cb99-1"></a>jdata</span>
<span id="cb99-2"><a href="import-export.html#cb99-2"></a><span class="co">#&gt; Response [http://api.open-notify.org/astros.json]</span></span>
<span id="cb99-3"><a href="import-export.html#cb99-3"></a><span class="co">#&gt;   Date: 2020-12-02 22:00</span></span>
<span id="cb99-4"><a href="import-export.html#cb99-4"></a><span class="co">#&gt;   Status: 200</span></span>
<span id="cb99-5"><a href="import-export.html#cb99-5"></a><span class="co">#&gt;   Content-Type: application/json</span></span>
<span id="cb99-6"><a href="import-export.html#cb99-6"></a><span class="co">#&gt;   Size: 356 B</span></span></code></pre></div>
<p>Als erstes fällt auf, dass die URL enthalten ist, an die die GET-Anfrage gesendet wurde. Außerdem sehen wir das Datum und die Uhrzeit, zu der die Anfrage gestellt wurde, sowie die Größe der Antwort.</p>
<p>Die Information <code>Content-Type</code> gibt uns eine Vorstellung davon, welche Form die Daten haben. Diese spezielle Antwort besagt, dass die Daten ein JSON-Format annehmen, womit auch klar ist warum wir das Paket <code>jsonlite</code> ebenfalls geladen haben.</p>
<p>Der Status verdient eine besondere Aufmerksamkeit. <code>Status</code> bezieht sich auf den Erfolg oder Misserfolg der API-Anfrage, und er wird in Form einer Zahl angegeben. Die zurückgegebene Nummer gibt Auskunft darüber, ob die Anfrage erfolgreich war oder nicht, und kann auch einige Gründe für einen möglichen Misserfolg nennen.</p>
<p>Die Zahl 200 ist das, was wir sehen wollen. Sie entspricht einem erfolgreichen Antrag, und das ist es, was wir hier haben. Eine Übersicht über weitere Status Codes findet man z.B. auf dieser [Webseite](<a href="https://www.restapitutorial.com/httpstatuscodes.html" class="uri">https://www.restapitutorial.com/httpstatuscodes.html</a>.</p>
</div>
<div id="handling-json-data" class="section level3">
<h3><span class="header-section-number">8.6.5</span> Handling JSON Data</h3>
<p><a href="https://www.json.org/json-en.html">JSON</a> steht für JavaScript Object Notation. Während JavaScript eine weitere Programmiersprache ist, liegt unser Schwerpunkt bei JSON auf seiner Struktur. JSON ist nützlich, weil es von einem Computer leicht lesbar ist, und aus diesem Grund ist es zur primären Art und Weise geworden, wie Daten über APIs transportiert werden. Die meisten APIs senden ihre Antworten im JSON-Format.</p>
<p>JSON ist als eine Reihe von Schlüssel-Werte-Paaren formatiert, wobei ein bestimmtes Wort (“Schlüssel”) mit einem bestimmten Wert assoziiert ist. Ein Beispiel für diese Schlüssel-Wert-Struktur ist unten dargestellt:</p>
<pre><code>{
    “name”: “Jane Doe”,
    “number_of_skills”: 2
}</code></pre>
<p>In ihrem aktuellen Zustand sind die Daten in der Variablen <code>jdata</code> nicht verwendbar. Die Daten sind als Unicode-Rohdaten in <code>jdata</code> enthalten, und müssen in das JSON-Format konvertiert werden.</p>
<p>Dazu müssen wir zunächst den rohen Unicode in Character Daten konvertieren, die dem oben gezeigten JSON-Format ähneln. Die Funktion <code>rawToChar()</code> führt genau diese Aufgabe aus:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="import-export.html#cb101-1"></a><span class="kw">rawToChar</span>(jdata<span class="op">$</span>content)</span>
<span id="cb101-2"><a href="import-export.html#cb101-2"></a><span class="co">#&gt; [1] &quot;{\&quot;message\&quot;: \&quot;success\&quot;, \&quot;number\&quot;: 7, \&quot;people\&quot;: [{\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Sergey Ryzhikov\&quot;}, {\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Kate Rubins\&quot;}, {\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Sergey Kud-Sverchkov\&quot;}, {\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Mike Hopkins\&quot;}, {\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Victor Glover\&quot;}, {\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Shannon Walker\&quot;}, {\&quot;craft\&quot;: \&quot;ISS\&quot;, \&quot;name\&quot;: \&quot;Soichi Noguchi\&quot;}]}&quot;</span></span></code></pre></div>
<p>Die resultierende Zeichenfolge sieht zwar recht unordentlich aus, aber es liegt wirklich die JSON-Struktur vor.</p>
<p>Ausgehend von diesem Character Vektor können wir nun mit <code>fromJSON()</code> aus dem <code>jsonlite</code> alles in ein Listenformat transformieren.</p>
<p>Die <code>fromJSON()</code> Funktion benötigt einen Character Vektor, der die JSON-Struktur enthält, die wir aus der Ausgabe von <code>rawToChar()</code> erhalten haben. Wenn wir also diese beiden Funktionen aneinanderreihen, erhalten wir die gewünschten Daten in einem Format, das wir in R leichter bearbeiten können.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="import-export.html#cb102-1"></a>data &lt;-<span class="st">  </span><span class="kw">fromJSON</span>(<span class="kw">rawToChar</span>(jdata<span class="op">$</span>content))</span>
<span id="cb102-2"><a href="import-export.html#cb102-2"></a><span class="kw">glimpse</span>(data)</span>
<span id="cb102-3"><a href="import-export.html#cb102-3"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb102-4"><a href="import-export.html#cb102-4"></a><span class="co">#&gt;  $ message: chr &quot;success&quot;</span></span>
<span id="cb102-5"><a href="import-export.html#cb102-5"></a><span class="co">#&gt;  $ number : int 7</span></span>
<span id="cb102-6"><a href="import-export.html#cb102-6"></a><span class="co">#&gt;  $ people :&#39;data.frame&#39;:	7 obs. of  2 variables:</span></span>
<span id="cb102-7"><a href="import-export.html#cb102-7"></a><span class="co">#&gt;   ..$ craft: chr [1:7] &quot;ISS&quot; &quot;ISS&quot; &quot;ISS&quot; &quot;ISS&quot; ...</span></span>
<span id="cb102-8"><a href="import-export.html#cb102-8"></a><span class="co">#&gt;   ..$ name : chr [1:7] &quot;Sergey Ryzhikov&quot; &quot;Kate Rubins&quot; &quot;Sergey Kud-Sverchkov&quot;&quot;..</span></span></code></pre></div>
<p>Die Liste <code>data</code> hat drei Elemente. Uns interessiert in erster Linie das Data Frame <code>people</code>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="import-export.html#cb103-1"></a>data<span class="op">$</span>people</span>
<span id="cb103-2"><a href="import-export.html#cb103-2"></a><span class="co">#&gt;   craft                 name</span></span>
<span id="cb103-3"><a href="import-export.html#cb103-3"></a><span class="co">#&gt; 1   ISS      Sergey Ryzhikov</span></span>
<span id="cb103-4"><a href="import-export.html#cb103-4"></a><span class="co">#&gt; 2   ISS          Kate Rubins</span></span>
<span id="cb103-5"><a href="import-export.html#cb103-5"></a><span class="co">#&gt; 3   ISS Sergey Kud-Sverchkov</span></span>
<span id="cb103-6"><a href="import-export.html#cb103-6"></a><span class="co">#&gt; 4   ISS         Mike Hopkins</span></span>
<span id="cb103-7"><a href="import-export.html#cb103-7"></a><span class="co">#&gt; 5   ISS        Victor Glover</span></span>
<span id="cb103-8"><a href="import-export.html#cb103-8"></a><span class="co">#&gt; 6   ISS       Shannon Walker</span></span>
<span id="cb103-9"><a href="import-export.html#cb103-9"></a><span class="co">#&gt; 7   ISS       Soichi Noguchi</span></span></code></pre></div>
<p>Also, da haben wir unsere Antwort: Zum Zeitpunkt des letzten Updates Wed Dec 2 23:00:59 2020 von R4ews befanden sich 7 Personen im Weltraum. Aber wenn du alles selbst ausprobierst, könnten es auch schon wieder andere Namen und eine andere Anzahl sein. Das ist einer der Vorteile von APIs - im Gegensatz zu herunterladbaren Datensätzen werden sie im Allgemeinen in Echtzeit oder nahezu in Echtzeit aktualisiert, so dass sie eine großartige Möglichkeit darstellen, Zugang zu sehr aktuellen Daten zu erhalten.</p>
<p>In diesem Beispiel haben wir einen sehr unkomplizierten API-Workflow durchlaufen. Die meisten APIs erfordern, dass Sie demselben allgemeinen Muster folgen, aber dabei können sie durchaus komplexer sein.</p>
<p>In unserem Beispiel war es ausreichen nur die URL anzugeben. Aber einige APIs verlangen durchaus mehr Informationen vom Benutzer. Im letzten Teil dieser Einführung gehen wir darauf ein, wie du der API mit deiner Anfrage zusätzliche Informationen zur Verfügung stellen kannst.</p>
</div>
<div id="apis-und-abfrageparameter" class="section level3">
<h3><span class="header-section-number">8.6.6</span> APIs und Abfrageparameter</h3>
<p>Was wäre, wenn wir wissen wollten, wann die ISS einen bestimmten Ort auf der Erde überfliegen würde? Die ISS Pass Times API von Open Notify verlangt von uns, dass wir zusätzliche Parameter angeben, bevor sie die gewünschten Daten zurückgeben kann.</p>
<p>Wir müssen den Längen- und Breitengrad des Ortes angeben, nach dem wir im Rahmen unserer <code>GET()</code> Anfrage fragen. Sobald ein Längen- und Breitengrad angegeben ist, werden sie als Abfrageparameter mit der ursprünglichen URL kombiniert.</p>
<p>Lass uns die API verwenden, um herauszufinden, wann die ISS Garching (auf 48.24896 Breiten- und 11.65101 Längengrad) passieren wird:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="import-export.html#cb104-1"></a>jdata &lt;-<span class="st">  </span><span class="kw">GET</span>(<span class="st">&quot;http://api.open-notify.org/iss-pass.json&quot;</span>,</span>
<span id="cb104-2"><a href="import-export.html#cb104-2"></a>    <span class="dt">query =</span> <span class="kw">list</span>(<span class="dt">lat =</span> <span class="fl">48.24896</span>, <span class="dt">lon =</span> <span class="fl">11.65101</span>))</span></code></pre></div>
<p>Man muss in der Dokumentation für die API, mit man arbeiten will, nachsehen, ob es erforderliche Abfrageparameter gibt. Für die überwiegende Mehrheit der APIs, auf die du möglicherweise zugreifen möchtest, gibt es eine Dokumentation, die du lesen kannst (und lesen solltest), um ein klares Verständnis dafür zu erhalten, welche Parameter deine Anfrage erfordert.</p>
<p>Wie auch immer, jetzt, da wir unsere Anfrage einschließlich der Standortparameter gestellt haben, können wir die Antwort mit den gleichen Funktionen überprüfen, die wir zuvor verwendet haben. Lass uns die Daten aus der Antwort extrahieren:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="import-export.html#cb105-1"></a>data &lt;-<span class="st"> </span><span class="kw">fromJSON</span>(<span class="kw">rawToChar</span>(jdata<span class="op">$</span>content))</span>
<span id="cb105-2"><a href="import-export.html#cb105-2"></a>data<span class="op">$</span>response</span>
<span id="cb105-3"><a href="import-export.html#cb105-3"></a><span class="co">#&gt;   duration   risetime</span></span>
<span id="cb105-4"><a href="import-export.html#cb105-4"></a><span class="co">#&gt; 1      529 1606995479</span></span>
<span id="cb105-5"><a href="import-export.html#cb105-5"></a><span class="co">#&gt; 2      650 1607001192</span></span>
<span id="cb105-6"><a href="import-export.html#cb105-6"></a><span class="co">#&gt; 3      651 1607007003</span></span>
<span id="cb105-7"><a href="import-export.html#cb105-7"></a><span class="co">#&gt; 4      651 1607012831</span></span>
<span id="cb105-8"><a href="import-export.html#cb105-8"></a><span class="co">#&gt; 5      647 1607018643</span></span></code></pre></div>
<p>Diese API gibt uns Zeiten in Form von <a href="https://de.wikipedia.org/wiki/Unixzeit">Unixzeit</a> zurück. Unixzeit ist die Zeitspanne, die seit dem 1. Januar 1970 vergangen ist. Mithilfe der Funktion <code>as_datetime()</code> aus dem <a href="https://lubridate.tidyverse.org">lubridate</a> Paket können wir die Unixzeit aber leicht umrechnen</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="import-export.html#cb106-1"></a>lubridate<span class="op">::</span><span class="kw">as_datetime</span>(data<span class="op">$</span>response<span class="op">$</span>risetime)</span>
<span id="cb106-2"><a href="import-export.html#cb106-2"></a><span class="co">#&gt; [1] &quot;2020-12-03 11:37:59 UTC&quot; &quot;2020-12-03 13:13:12 UTC&quot;</span></span>
<span id="cb106-3"><a href="import-export.html#cb106-3"></a><span class="co">#&gt; [3] &quot;2020-12-03 14:50:03 UTC&quot; &quot;2020-12-03 16:27:11 UTC&quot;</span></span>
<span id="cb106-4"><a href="import-export.html#cb106-4"></a><span class="co">#&gt; [5] &quot;2020-12-03 18:04:03 UTC&quot;</span></span></code></pre></div>
<p>Wir haben hier wirklich nur die Basics in Bezug auf APIs eingeführt. Aber hoffentlich hat dir diese Einführung trotzdem das Vertrauen gegeben, sich mit einigen komplexeren und leistungsfähigeren APIs auseinanderzusetzen, und trägt dadurch dazu bei, eine ganz neue Welt von Daten zu erschließen, die du erforschen kannst!</p>
</div>
</div>
<div id="weiteres-material" class="section level2">
<h2><span class="header-section-number">8.7</span> Weiteres Material</h2>
<p>Hier sein noch auf das Kapitel <a href="http://r4ds.had.co.nz/data-import.html">Data import</a> im Buch <a href="https://r4ds.had.co.nz">R for Data Science</a> von Hadley Wickham und Garrett Grolemund <span class="citation">(<a href="literatur.html#ref-wickham2016" role="doc-biblioref">2016</a>)</span> verwiesen für weitere Information zum Daten Import.</p>
<!--STAT 545 external resources/content-->
<!--Packages: main link-->
<!--Packages: vignettes & CRAN/GitHub links-->
<!--Bookdowns: main link-->
<!--Bookdowns: specific chapters-->
<!--RStudio Cheat Sheets-->
<!--Blog posts, slides, & papers-->
<!--Papers/Books Cited-->
<!--Misc.-->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr-single.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="literatur.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R4ews.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
